  <h1>Posts#index</h1>
  <p>Find me in app/views/posts/index.html.erb</p>

  <% if admin %>
    <%= link_to "Add Note", new_post_path %>
  <% end %>

  <% @posts.each do |post| %>
    <h2><%= post.title %></h2>
    <em><%= post.updated_at.strftime("Posted on %B %d, %Y") %></em>
    <p><%= post.body %></p>
    Tags:
    <%post.tags.each do |tag| %>
      <%= link_to "#{tag.name}", tag_path(tag) %>
    <% end %>

    <% if admin %>
      <p>
        <u>Not yet commented:</u>
          <% User.all.map {|user| user.name}.reject{|name| name if post.comments.map {|comment| comment.user.name}.uniq.include?(name)}.each do |name| %>
            <li><%= name %></li>
          <% end %>
      </p>

      <p>
        <%= link_to "Edit Post", edit_post_path(post) %> |
        <%= link_to "Delete Post", post,  method: :delete, data: { confirm: 'Are you sure?' } %>
      </p>
    <% end %>

    <p><%= link_to "Add Comment", new_post_comment_path(post.id) %></p>

    <% post.comments.each do |comment| %>
      <p>
        <strong><%= comment.user.name + " " + comment.created_at.strftime("left a comment on %B %d, %Y:") %></strong><br>
        <%= comment.body %> <%= link_to "(edit)", edit_post_comment_path(post.id, comment) if comment.user.id == current_user.id %></p>
      </p>
    <% end %>

  <% end %>

